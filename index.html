<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CapitalRise Pro Trading Platform</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ================= BASE STYLES ================= */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: radial-gradient(circle at top, #0f0f23, #050510);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ================= HEADER ================= */
        .header {
            height: 70px;
            background: linear-gradient(90deg, #6a11cb 0%, #2575fc 100%);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            font-size: 24px;
            font-weight: 700;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 10px 30px rgba(106, 17, 203, 0.4);
            backdrop-filter: blur(10px);
        }

        .header-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-logo i {
            font-size: 28px;
            background: linear-gradient(90deg, #ff6b6b, #ffd93d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-stats {
            display: flex;
            gap: 25px;
            font-size: 14px;
            opacity: 0.9;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ================= LOADING SCREEN ================= */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0a1a;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s;
        }

        .loader {
            width: 80px;
            height: 80px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top: 5px solid #6a11cb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ================= AUTH PAGES ================= */
        .auth-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><path fill="%231a1a2e" d="M0 0h1000v1000H0z"/><path fill="%2316202e" d="M0 500q250-250 500 0t500 0v500H0z"/></svg>') no-repeat center center fixed;
            background-size: cover;
        }

        .auth-card {
            width: 100%;
            max-width: 450px;
            background: rgba(15, 15, 35, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(106, 17, 203, 0.3);
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .auth-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .auth-header h2 {
            background: linear-gradient(90deg, #6a11cb, #2575fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 32px;
            margin-bottom: 10px;
        }

        /* ================= DASHBOARD LAYOUT ================= */
        .dashboard-container {
            display: none;
            min-height: calc(100vh - 70px);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100%;
        }

        /* ================= SIDEBAR ================= */
        .sidebar {
            background: linear-gradient(180deg, #0f0f23 0%, #0a0a1a 100%);
            border-right: 1px solid rgba(255, 255, 255, 0.05);
            padding: 25px 20px;
            overflow-y: auto;
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
        }

        .user-profile {
            text-align: center;
            padding: 25px 15px;
            background: rgba(106, 17, 203, 0.1);
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(106, 17, 203, 0.2);
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #6a11cb, #2575fc);
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            color: white;
            box-shadow: 0 10px 30px rgba(106, 17, 203, 0.3);
        }

        .nav-section {
            margin-bottom: 30px;
        }

        .nav-section h3 {
            color: #6a11cb;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            padding-left: 10px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            margin-bottom: 8px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            color: rgba(255, 255, 255, 0.7);
            border: 1px solid transparent;
        }

        .nav-item:hover {
            background: rgba(106, 17, 203, 0.1);
            border-color: rgba(106, 17, 203, 0.2);
            color: white;
            transform: translateX(5px);
        }

        .nav-item.active {
            background: linear-gradient(90deg, rgba(106, 17, 203, 0.2), rgba(37, 117, 252, 0.2));
            border-color: rgba(106, 17, 203, 0.3);
            color: white;
        }

        .nav-item i {
            width: 20px;
            font-size: 18px;
        }

        /* ================= MAIN CONTENT ================= */
        .main-content {
            padding: 30px;
            background: rgba(10, 10, 26, 0.5);
            overflow-y: auto;
            height: calc(100vh - 70px);
        }

        .page {
            display: none;
            animation: fadeIn 0.3s;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* ================= STATS CARDS ================= */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.9), rgba(10, 10, 26, 0.9));
            padding: 25px;
            border-radius: 20px;
            border: 1px solid rgba(106, 17, 203, 0.2);
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: rgba(106, 17, 203, 0.4);
            box-shadow: 0 15px 40px rgba(106, 17, 203, 0.2);
        }

        .stat-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 40px;
            opacity: 0.1;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin: 10px 0;
            background: linear-gradient(90deg, #6a11cb, #2575fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ================= PACKAGES GRID ================= */
        .packages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .package-card {
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.9), rgba(10, 10, 26, 0.9));
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(106, 17, 203, 0.3);
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }

        .package-card:hover {
            transform: translateY(-10px);
            border-color: #6a11cb;
            box-shadow: 0 20px 50px rgba(106, 17, 203, 0.3);
        }

        .package-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(90deg, #ff6b6b, #ffd93d);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        /* ================= TABLE STYLES ================= */
        .data-table {
            width: 100%;
            background: rgba(15, 15, 35, 0.9);
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid rgba(106, 17, 203, 0.2);
        }

        .data-table th {
            background: linear-gradient(90deg, #6a11cb, #2575fc);
            padding: 18px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 14px;
        }

        .data-table td {
            padding: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .data-table tr:hover {
            background: rgba(106, 17, 203, 0.05);
        }

        /* ================= FORM STYLES ================= */
        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 10px;
            color: #6a11cb;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(106, 17, 203, 0.2);
            border-radius: 12px;
            color: white;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: #6a11cb;
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.2);
        }

        /* ================= BUTTONS ================= */
        .btn {
            padding: 16px 32px;
            border-radius: 12px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(90deg, #6a11cb, #2575fc);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(106, 17, 203, 0.3);
        }

        .btn-success {
            background: linear-gradient(90deg, #00b09b, #96c93d);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(90deg, #ff416c, #ff4b2b);
            color: white;
        }

        /* ================= MODAL STYLES ================= */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #0f0f23, #0a0a1a);
            border-radius: 25px;
            padding: 40px;
            width: 90%;
            max-width: 600px;
            border: 1px solid rgba(106, 17, 203, 0.3);
            position: relative;
            animation: modalSlideUp 0.4s;
        }

        @keyframes modalSlideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* ================= TOAST NOTIFICATION ================= */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 20px 30px;
            background: linear-gradient(90deg, #6a11cb, #2575fc);
            color: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(106, 17, 203, 0.3);
            z-index: 9998;
            animation: slideInRight 0.3s;
            max-width: 400px;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* ================= RESPONSIVE DESIGN ================= */
        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: fixed;
                left: -300px;
                top: 70px;
                width: 280px;
                height: calc(100vh - 70px);
                z-index: 998;
                transition: left 0.3s;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .mobile-menu-btn {
                display: block;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .packages-grid {
                grid-template-columns: 1fr;
            }
            
            .main-content {
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .auth-card {
                padding: 25px;
            }
            
            .header {
                padding: 0 15px;
                font-size: 20px;
            }
        }
    </style>
</head>
<body>

<!-- ================= LOADING SCREEN ================= -->
<div class="loading-screen" id="loadingScreen">
    <div class="loader"></div>
    <h2 style="margin-top: 20px; color: #6a11cb;">Loading CapitalRise Pro</h2>
    <p style="margin-top: 10px; opacity: 0.7;">Initializing Centralized System...</p>
</div>

<!-- ================= HEADER ================= -->
<div class="header">
    <div class="header-logo">
        <i class="fas fa-chart-line"></i>
        <span>CapitalRise Pro</span>
    </div>
    <div class="header-stats">
        <div class="stat-item">
            <i class="fas fa-users"></i>
            <span>Users: <span id="headerUsers">0</span></span>
        </div>
        <div class="stat-item">
            <i class="fas fa-wallet"></i>
            <span>Balance: ₹<span id="headerBalance">0</span></span>
        </div>
    </div>
</div>

<!-- ================= AUTH PAGES ================= -->
<div id="authContainer" class="auth-container">
    <!-- Login Page -->
    <div class="auth-card" id="loginPage">
        <div class="auth-header">
            <h2>Welcome Back</h2>
            <p style="opacity: 0.7; margin-top: 5px;">Sign in to your account</p>
        </div>
        
        <div class="form-group">
            <label class="form-label">User ID</label>
            <input type="text" class="form-input" id="loginUserId" placeholder="Enter your User ID" value="USER0001">
        </div>
        
        <div class="form-group">
            <label class="form-label">Password</label>
            <input type="password" class="form-input" id="loginPassword" placeholder="Enter your password" value="password123">
        </div>
        
        <button class="btn btn-primary" onclick="loginUser()" style="width: 100%; margin-top: 10px;">
            <i class="fas fa-sign-in-alt"></i> Login
        </button>
        
        <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
            <p style="opacity: 0.7; margin-bottom: 15px;">Don't have an account?</p>
            <button class="btn" onclick="showRegisterPage()" style="background: transparent; border: 1px solid #6a11cb; color: #6a11cb; width: 100%;">
                <i class="fas fa-user-plus"></i> Create New Account
            </button>
            <p style="margin-top: 20px; font-size: 14px; opacity: 0.5;">
                Admin? <a href="javascript:void(0)" onclick="showAdminLogin()" style="color: #6a11cb; text-decoration: none;">Click here</a>
            </p>
        </div>
    </div>

    <!-- Register Page -->
    <div class="auth-card" id="registerPage" style="display: none;">
        <div class="auth-header">
            <h2>Create Account</h2>
            <p style="opacity: 0.7; margin-top: 5px;">Join CapitalRise Pro Trading</p>
        </div>
        
        <div class="form-group">
            <label class="form-label">Full Name</label>
            <input type="text" class="form-input" id="regName" placeholder="Enter your full name">
        </div>
        
        <div class="form-group">
            <label class="form-label">Email Address</label>
            <input type="email" class="form-input" id="regEmail" placeholder="Enter your email">
        </div>
        
        <div class="form-group">
            <label class="form-label">Mobile Number</label>
            <input type="tel" class="form-input" id="regMobile" placeholder="Enter your mobile number">
        </div>
        
        <div class="form-group">
            <label class="form-label">Password</label>
            <input type="password" class="form-input" id="regPassword" placeholder="Create a password">
        </div>
        
        <div class="form-group">
            <label class="form-label">Sponsor ID (Optional)</label>
            <input type="text" class="form-input" id="regSponsor" placeholder="Enter sponsor ID if any">
        </div>
        
        <button class="btn btn-primary" onclick="registerUser()" style="width: 100%; margin-top: 10px;">
            <i class="fas fa-user-plus"></i> Create Account
        </button>
        
        <div style="text-align: center; margin-top: 30px;">
            <button class="btn" onclick="showLoginPage()" style="background: transparent; border: none; color: #6a11cb;">
                <i class="fas fa-arrow-left"></i> Back to Login
            </button>
        </div>
    </div>

    <!-- Admin Login -->
    <div class="auth-card" id="adminLoginPage" style="display: none;">
        <div class="auth-header">
            <h2>Admin Login</h2>
            <p style="opacity: 0.7; margin-top: 5px;">Restricted Access</p>
        </div>
        
        <div class="form-group">
            <label class="form-label">Admin ID</label>
            <input type="text" class="form-input" id="adminId" placeholder="Enter Admin ID" value="admin">
        </div>
        
        <div class="form-group">
            <label class="form-label">Password</label>
            <input type="password" class="form-input" id="adminPassword" placeholder="Enter Admin Password" value="admin123">
        </div>
        
        <button class="btn btn-primary" onclick="loginAdmin()" style="width: 100%; margin-top: 10px;">
            <i class="fas fa-lock"></i> Admin Login
        </button>
        
        <div style="text-align: center; margin-top: 30px;">
            <button class="btn" onclick="showLoginPage()" style="background: transparent; border: none; color: #6a11cb;">
                <i class="fas fa-arrow-left"></i> Back to User Login
            </button>
        </div>
    </div>
</div>

<!-- ================= USER DASHBOARD ================= -->
<div class="dashboard-container" id="userDashboard">
    <div class="dashboard-grid">
        <!-- Sidebar -->
        <div class="sidebar" id="userSidebar">
            <div class="user-profile">
                <div class="user-avatar" id="userAvatar">U</div>
                <h3 id="userName">User Name</h3>
                <p style="opacity: 0.7; font-size: 14px; margin-top: 5px;">ID: <span id="userIdDisplay">USER0001</span></p>
                <div style="margin-top: 15px; padding: 8px 15px; background: rgba(0, 176, 155, 0.1); border-radius: 20px; display: inline-block;">
                    <span style="color: #00b09b; font-size: 12px; font-weight: 600;">ACTIVE</span>
                </div>
            </div>

            <!-- Navigation -->
            <div class="nav-section">
                <h3>Dashboard</h3>
                <div class="nav-item active" onclick="showPage('dashboard')">
                    <i class="fas fa-home"></i>
                    <span>Overview</span>
                </div>
                <div class="nav-item" onclick="showPage('profile')">
                    <i class="fas fa-user"></i>
                    <span>Profile</span>
                </div>
                <div class="nav-item" onclick="showPage('packages')">
                    <i class="fas fa-cube"></i>
                    <span>Investment Plans</span>
                </div>
            </div>

            <div class="nav-section">
                <h3>Transactions</h3>
                <div class="nav-item" onclick="showPage('deposit')">
                    <i class="fas fa-plus-circle"></i>
                    <span>Deposit Funds</span>
                </div>
                <div class="nav-item" onclick="showPage('withdraw')">
                    <i class="fas fa-wallet"></i>
                    <span>Withdraw</span>
                </div>
                <div class="nav-item" onclick="showPage('transactions')">
                    <i class="fas fa-history"></i>
                    <span>Transaction History</span>
                </div>
            </div>

            <div class="nav-section">
                <h3>Earnings</h3>
                <div class="nav-item" onclick="showPage('earnings')">
                    <i class="fas fa-chart-line"></i>
                    <span>Earnings Report</span>
                </div>
                <div class="nav-item" onclick="showPage('referrals')">
                    <i class="fas fa-users"></i>
                    <span>Referral Network</span>
                </div>
                <div class="nav-item" onclick="showPage('tasks')">
                    <i class="fas fa-tasks"></i>
                    <span>Daily Tasks</span>
                </div>
            </div>

            <div class="nav-section">
                <h3>Account</h3>
                <div class="nav-item" onclick="showPage('settings')">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </div>
                <div class="nav-item" onclick="logoutUser()" style="color: #ff416c;">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Page -->
            <div class="page active" id="pageDashboard">
                <div style="margin-bottom: 30px;">
                    <h1 style="font-size: 32px; margin-bottom: 10px; background: linear-gradient(90deg, #6a11cb, #2575fc); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Dashboard Overview</h1>
                    <p style="opacity: 0.7;">Welcome back to your trading dashboard</p>
                </div>

                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-wallet stat-icon"></i>
                        <div style="font-size: 14px; opacity: 0.7;">Available Balance</div>
                        <div class="stat-value" id="balanceAmount">₹0</div>
                        <div style="font-size: 12px; opacity: 0.5;">+₹0 today</div>
                    </div>
                    
                    <div class="stat-card">
                        <i class="fas fa-chart-line stat-icon"></i>
                        <div style="font-size: 14px; opacity: 0.7;">Total Investment</div>
                        <div class="stat-value" id="investmentAmount">₹0</div>
                        <div style="font-size: 12px; opacity: 0.5;">Active Packages</div>
                    </div>
                    
                    <div class="stat-card">
                        <i class="fas fa-money-bill-wave stat-icon"></i>
                        <div style="font-size: 14px; opacity: 0.7;">Total Earnings</div>
                        <div class="stat-value" id="earningsAmount">₹0</div>
                        <div style="font-size: 12px; opacity: 0.5;">Lifetime</div>
                    </div>
                    
                    <div class="stat-card">
                        <i class="fas fa-users stat-icon"></i>
                        <div style="font-size: 14px; opacity: 0.7;">Referrals</div>
                        <div class="stat-value" id="referralsCount">0</div>
                        <div style="font-size: 12px; opacity: 0.5;">Active: 0</div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 40px 0;">
                    <button class="btn btn-primary" onclick="showPage('deposit')">
                        <i class="fas fa-plus-circle"></i> Add Funds
                    </button>
                    <button class="btn btn-success" onclick="showPage('packages')">
                        <i class="fas fa-cube"></i> Invest Now
                    </button>
                    <button class="btn" onclick="showPage('referrals')" style="background: linear-gradient(90deg, #8E2DE2, #4A00E0); color: white;">
                        <i class="fas fa-users"></i> Refer & Earn
                    </button>
                    <button class="btn" onclick="showPage('tasks')" style="background: linear-gradient(90deg, #f46b45, #eea849); color: white;">
                        <i class="fas fa-tasks"></i> Daily Tasks
                    </button>
                </div>

                <!-- Recent Activity -->
                <div style="background: rgba(15, 15, 35, 0.9); border-radius: 20px; padding: 30px; border: 1px solid rgba(106, 17, 203, 0.2); margin-top: 30px;">
                    <h3 style="margin-bottom: 20px; color: #6a11cb;">Recent Activity</h3>
                    <div id="recentActivity">
                        <p style="text-align: center; padding: 40px; opacity: 0.5;">No recent activity</p>
                    </div>
                </div>
            </div>

            <!-- Other pages will be dynamically loaded -->
            <div id="pageContent"></div>
        </div>
    </div>
</div>

<!-- ================= ADMIN DASHBOARD ================= -->
<div class="dashboard-container" id="adminDashboard" style="display: none;">
    <div class="dashboard-grid">
        <!-- Admin Sidebar -->
        <div class="sidebar">
            <div class="user-profile">
                <div class="user-avatar" style="background: linear-gradient(135deg, #ff416c, #ff4b2b);">A</div>
                <h3>Admin Panel</h3>
                <p style="opacity: 0.7; font-size: 14px; margin-top: 5px;">Full Control Access</p>
            </div>

            <div class="nav-section">
                <h3>Dashboard</h3>
                <div class="nav-item active" onclick="showAdminPage('adminOverview')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Overview</span>
                </div>
                <div class="nav-item" onclick="showAdminPage('adminUsers')">
                    <i class="fas fa-users"></i>
                    <span>All Users</span>
                </div>
                <div class="nav-item" onclick="showAdminPage('adminTransactions')">
                    <i class="fas fa-exchange-alt"></i>
                    <span>All Transactions</span>
                </div>
            </div>

            <div class="nav-section">
                <h3>Management</h3>
                <div class="nav-item" onclick="showAdminPage('adminDeposits')">
                    <i class="fas fa-money-check-alt"></i>
                    <span>Deposit Requests</span>
                </div>
                <div class="nav-item" onclick="showAdminPage('adminWithdrawals')">
                    <i class="fas fa-wallet"></i>
                    <span>Withdrawal Requests</span>
                </div>
                <div class="nav-item" onclick="showAdminPage('adminPackages')">
                    <i class="fas fa-box-open"></i>
                    <span>Package Activations</span>
                </div>
            </div>

            <div class="nav-section">
                <h3>System</h3>
                <div class="nav-item" onclick="showAdminPage('adminSettings')">
                    <i class="fas fa-cogs"></i>
                    <span>System Settings</span>
                </div>
                <div class="nav-item" onclick="showAdminPage('adminReports')">
                    <i class="fas fa-chart-bar"></i>
                    <span>Reports</span>
                </div>
                <div class="nav-item" onclick="adminLogout()" style="color: #ff416c;">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </div>
            </div>
        </div>

        <!-- Admin Main Content -->
        <div class="main-content">
            <div id="adminPageContent">
                <!-- Admin pages will be loaded here -->
            </div>
        </div>
    </div>
</div>

<!-- ================= MODALS ================= -->
<div class="modal-overlay" id="modalOverlay">
    <div class="modal-content" id="modalContent">
        <!-- Modal content will be loaded here -->
    </div>
</div>

<!-- ================= TOAST CONTAINER ================= -->
<div id="toastContainer"></div>

<script>
// ================= GLOBAL VARIABLES =================
let currentUser = null;
let currentAdmin = null;
let isInitialized = false;

// ================= CENTRALIZED STORAGE SYSTEM =================
const STORAGE_KEY = 'capitalrise_pro_data_v3';
const SESSION_KEY = 'capitalrise_session';
const BACKUP_KEY = 'capitalrise_backup_';

// Central data structure - यहाँ सारा डेटा है
let centralData = {
    // Admin credentials (only one admin)
    admin: {
        id: 'admin',
        name: 'System Administrator',
        password: 'admin123',
        email: 'admin@capitalrise.com',
        lastLogin: null,
        permissions: ['all']
    },
    
    // All users data - सभी यूजर्स यहाँ
    users: {},
    
    // Platform settings
    settings: {
        minDeposit: 100,
        minWithdrawal: 200,
        withdrawalFee: 2,
        referralBonus: 10,
        dailyTaskRate: 5,
        packageValidity: 30,
        platformBalance: 100000,
        currency: '₹',
        upiId: 'capitalrise@ybl'
    },
    
    // All transactions
    transactions: [],
    
    // All requests
    depositRequests: [],
    withdrawalRequests: [],
    packageRequests: [],
    
    // System logs
    logs: [],
    
    // Auto-increment IDs
    userIdCounter: 1,
    transactionIdCounter: 1,
    requestIdCounter: 1
};

// ================= INITIALIZATION =================
document.addEventListener('DOMContentLoaded', function() {
    initializeSystem();
});

function initializeSystem() {
    // Load existing data
    loadCentralData();
    
    // Check for existing session
    checkExistingSession();
    
    // Initialize UI
    initializeUI();
    
    // Set up auto-save
    setupAutoSave();
    
    // Hide loading screen
    setTimeout(() => {
        document.getElementById('loadingScreen').style.opacity = '0';
        setTimeout(() => {
            document.getElementById('loadingScreen').style.display = 'none';
        }, 500);
    }, 1000);
}

function loadCentralData() {
    try {
        const savedData = localStorage.getItem(STORAGE_KEY);
        
        if (savedData) {
            const parsedData = JSON.parse(savedData);
            
            // Merge with default structure
            centralData = {
                ...centralData,
                ...parsedData,
                users: {
                    ...centralData.users,
                    ...parsedData.users
                }
            };
            
            // Ensure default user exists
            if (!centralData.users['USER0001']) {
                createDefaultUser();
            }
            
            console.log('✅ Central data loaded:', Object.keys(centralData.users).length, 'users');
        } else {
            createDefaultData();
        }
        
        // Create backup
        createBackup();
        
    } catch (error) {
        console.error('❌ Error loading data:', error);
        createDefaultData();
    }
}

function createDefaultData() {
    // Reset to defaults
    centralData = {
        admin: {
            id: 'admin',
            name: 'System Administrator',
            password: 'admin123',
            email: 'admin@capitalrise.com',
            lastLogin: new Date().toISOString(),
            permissions: ['all']
        },
        users: {},
        settings: {
            minDeposit: 100,
            minWithdrawal: 200,
            withdrawalFee: 2,
            referralBonus: 10,
            dailyTaskRate: 5,
            packageValidity: 30,
            platformBalance: 100000,
            currency: '₹',
            upiId: 'capitalrise@ybl'
        },
        transactions: [],
        depositRequests: [],
        withdrawalRequests: [],
        packageRequests: [],
        logs: [],
        userIdCounter: 1,
        transactionIdCounter: 1,
        requestIdCounter: 1
    };
    
    createDefaultUser();
    saveCentralData();
    
    console.log('✅ Default data created');
}

function createDefaultUser() {
    // Create demo user
    centralData.users['USER0001'] = {
        id: 'USER0001',
        name: 'Demo User',
        email: 'demo@capitalrise.com',
        mobile: '+91 9876543210',
        password: 'password123',
        sponsor: 'SYSTEM',
        joinDate: new Date().toISOString(),
        status: 'active',
        balance: 5000,
        investment: 10000,
        earnings: 2500,
        referrals: 3,
        package: 'PRO',
        kyc: 'verified',
        bankDetails: {
            accountNumber: 'XXXXXX1234',
            bankName: 'State Bank of India',
            ifsc: 'SBIN0001234'
        },
        lastLogin: new Date().toISOString(),
        devices: [navigator.userAgent],
        transactions: [],
        activityLog: []
    };
    
    centralData.userIdCounter = 2;
    
    console.log('✅ Default user created');
}

function saveCentralData() {
    try {
        // Save main data
        localStorage.setItem(STORAGE_KEY, JSON.stringify(centralData));
        
        // Update stats
        updateHeaderStats();
        
        // Log the save
        logActivity('SYSTEM', 'Data saved successfully');
        
    } catch (error) {
        console.error('❌ Error saving data:', error);
        showToast('Error saving data. Please check storage space.', 'error');
    }
}

function createBackup() {
    const timestamp = Date.now();
    const backupData = {
        timestamp: timestamp,
        data: JSON.parse(JSON.stringify(centralData))
    };
    
    localStorage.setItem(BACKUP_KEY + timestamp, JSON.stringify(backupData));
    
    // Keep only last 5 backups
    const backupKeys = Object.keys(localStorage).filter(key => key.startsWith(BACKUP_KEY));
    if (backupKeys.length > 5) {
        backupKeys.sort().slice(0, -5).forEach(key => {
            localStorage.removeItem(key);
        });
    }
}

function checkExistingSession() {
    const sessionData = localStorage.getItem(SESSION_KEY);
    if (sessionData) {
        try {
            const session = JSON.parse(sessionData);
            
            if (session.type === 'user' && centralData.users[session.userId]) {
                currentUser = centralData.users[session.userId];
                showUserDashboard();
            } else if (session.type === 'admin' && session.userId === 'admin') {
                currentAdmin = centralData.admin;
                showAdminDashboard();
            }
        } catch (error) {
            localStorage.removeItem(SESSION_KEY);
        }
    }
}

function setupAutoSave() {
    // Auto-save every 30 seconds
    setInterval(() => {
        if (isInitialized) {
            saveCentralData();
        }
    }, 30000);
    
    // Auto-backup every 5 minutes
    setInterval(() => {
        createBackup();
    }, 300000);
}

// ================= AUTH FUNCTIONS =================
function showLoginPage() {
    document.getElementById('loginPage').style.display = 'block';
    document.getElementById('registerPage').style.display = 'none';
    document.getElementById('adminLoginPage').style.display = 'none';
}

function showRegisterPage() {
    document.getElementById('loginPage').style.display = 'none';
    document.getElementById('registerPage').style.display = 'block';
    document.getElementById('adminLoginPage').style.display = 'none';
}

function showAdminLogin() {
    document.getElementById('loginPage').style.display = 'none';
    document.getElementById('registerPage').style.display = 'none';
    document.getElementById('adminLoginPage').style.display = 'block';
}

function loginUser() {
    const userId = document.getElementById('loginUserId').value.trim().toUpperCase();
    const password = document.getElementById('loginPassword').value;
    
    if (!userId || !password) {
        showToast('Please enter User ID and Password', 'error');
        return;
    }
    
    // Check if user exists
    const user = centralData.users[userId];
    
    if (!user) {
        showToast('User ID not found', 'error');
        return;
    }
    
    if (user.password !== password) {
        showToast('Invalid password', 'error');
        return;
    }
    
    if (user.status !== 'active') {
        showToast('Account is ' + user.status, 'error');
        return;
    }
    
    // Set current user
    currentUser = user;
    
    // Update last login
    user.lastLogin = new Date().toISOString();
    
    // Save session
    localStorage.setItem(SESSION_KEY, JSON.stringify({
        type: 'user',
        userId: userId,
        timestamp: Date.now()
    }));
    
    // Log activity
    logActivity(userId, 'User login');
    
    // Save data
    saveCentralData();
    
    // Show dashboard
    showUserDashboard();
    showToast(`Welcome back, ${user.name}!`, 'success');
}

function registerUser() {
    const name = document.getElementById('regName').value.trim();
    const email = document.getElementById('regEmail').value.trim();
    const mobile = document.getElementById('regMobile').value.trim();
    const password = document.getElementById('regPassword').value;
    const sponsor = document.getElementById('regSponsor').value.trim().toUpperCase();
    
    if (!name || !email || !mobile || !password) {
        showToast('Please fill all required fields', 'error');
        return;
    }
    
    if (password.length < 6) {
        showToast('Password must be at least 6 characters', 'error');
        return;
    }
    
    // Check sponsor if provided
    if (sponsor && !centralData.users[sponsor]) {
        showToast('Sponsor ID not found', 'error');
        return;
    }
    
    // Generate user ID
    const userId = 'USER' + String(centralData.userIdCounter++).padStart(4, '0');
    
    // Create new user
    centralData.users[userId] = {
        id: userId,
        name: name,
        email: email,
        mobile: mobile,
        password: password,
        sponsor: sponsor || 'SYSTEM',
        joinDate: new Date().toISOString(),
        status: 'active',
        balance: 100, // Welcome bonus
        investment: 0,
        earnings: 0,
        referrals: 0,
        package: 'none',
        kyc: 'pending',
        bankDetails: {},
        lastLogin: new Date().toISOString(),
        devices: [navigator.userAgent],
        transactions: [],
        activityLog: []
    };
    
    // Add welcome bonus transaction
    addTransaction({
        type: 'bonus',
        userId: userId,
        amount: 100,
        description: 'Welcome bonus for new registration'
    });
    
    // Update sponsor if exists
    if (sponsor && centralData.users[sponsor]) {
        const sponsorUser = centralData.users[sponsor];
        sponsorUser.referrals = (sponsorUser.referrals || 0) + 1;
        
        // Add referral bonus to sponsor
        const referralBonus = centralData.settings.referralBonus;
        sponsorUser.balance += referralBonus;
        
        addTransaction({
            type: 'referral',
            userId: sponsor,
            amount: referralBonus,
            description: `Referral bonus for ${userId}`
        });
        
        showToast(`Referral bonus of ₹${referralBonus} added to ${sponsor}`, 'success');
    }
    
    // Save data
    saveCentralData();
    
    // Show success message
    showToast(`Account created successfully! Your User ID is ${userId}`, 'success');
    
    // Auto login
    document.getElementById('loginUserId').value = userId;
    document.getElementById('loginPassword').value = password;
    
    showLoginPage();
}

function loginAdmin() {
    const adminId = document.getElementById('adminId').value.trim();
    const password = document.getElementById('adminPassword').value;
    
    if (adminId === centralData.admin.id && password === centralData.admin.password) {
        currentAdmin = centralData.admin;
        currentAdmin.lastLogin = new Date().toISOString();
        
        // Save session
        localStorage.setItem(SESSION_KEY, JSON.stringify({
            type: 'admin',
            userId: adminId,
            timestamp: Date.now()
        }));
        
        // Log activity
        logActivity('ADMIN', 'Admin login');
        
        // Save data
        saveCentralData();
        
        // Show admin dashboard
        showAdminDashboard();
        showToast('Admin login successful!', 'success');
    } else {
        showToast('Invalid admin credentials', 'error');
    }
}

function logoutUser() {
    if (currentUser) {
        logActivity(currentUser.id, 'User logout');
    }
    
    currentUser = null;
    localStorage.removeItem(SESSION_KEY);
    location.reload();
}

function adminLogout() {
    if (currentAdmin) {
        logActivity('ADMIN', 'Admin logout');
    }
    
    currentAdmin = null;
    localStorage.removeItem(SESSION_KEY);
    location.reload();
}

// ================= DASHBOARD FUNCTIONS =================
function showUserDashboard() {
    document.getElementById('authContainer').style.display = 'none';
    document.getElementById('userDashboard').style.display = 'block';
    
    // Update user info
    updateUserInfo();
    
    // Initialize dashboard
    initializeDashboard();
}

function showAdminDashboard() {
    document.getElementById('authContainer').style.display = 'none';
    document.getElementById('adminDashboard').style.display = 'block';
    
    // Initialize admin dashboard
    initializeAdminDashboard();
}

function updateUserInfo() {
    if (!currentUser) return;
    
    document.getElementById('userName').textContent = currentUser.name;
    document.getElementById('userIdDisplay').textContent = currentUser.id;
    document.getElementById('userAvatar').textContent = currentUser.name.charAt(0).toUpperCase();
    
    // Update stats
    document.getElementById('balanceAmount').textContent = '₹' + currentUser.balance.toLocaleString();
    document.getElementById('investmentAmount').textContent = '₹' + currentUser.investment.toLocaleString();
    document.getElementById('earningsAmount').textContent = '₹' + currentUser.earnings.toLocaleString();
    document.getElementById('referralsCount').textContent = currentUser.referrals || 0;
    
    // Update header
    updateHeaderStats();
}

function updateHeaderStats() {
    const totalUsers = Object.keys(centralData.users).length;
    const totalBalance = Object.values(centralData.users).reduce((sum, user) => sum + (user.balance || 0), 0);
    
    document.getElementById('headerUsers').textContent = totalUsers;
    document.getElementById('headerBalance').textContent = totalBalance.toLocaleString();
}

// ================= PAGE NAVIGATION =================
function showPage(page) {
    // Remove active class from all nav items
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
    });
    
    // Add active class to clicked item
    event.currentTarget.classList.add('active');
    
    // Hide all pages
    document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
    });
    
    // Show selected page
    document.getElementById('pageDashboard').classList.remove('active');
    document.getElementById('pageContent').innerHTML = getPageContent(page);
}

function getPageContent(page) {
    switch(page) {
        case 'dashboard':
            return `<div class="page active" id="pageDashboard"></div>`;
        case 'profile':
            return getUserProfilePage();
        case 'packages':
            return getPackagesPage();
        case 'deposit':
            return getDepositPage();
        case 'withdraw':
            return getWithdrawPage();
        case 'transactions':
            return getTransactionsPage();
        case 'earnings':
            return getEarningsPage();
        case 'referrals':
            return getReferralsPage();
        case 'tasks':
            return getTasksPage();
        case 'settings':
            return getSettingsPage();
        default:
            return '<h2>Page not found</h2>';
    }
}

// ================= PAGE TEMPLATES =================
function getUserProfilePage() {
    if (!currentUser) return '';
    
    return `
        <div class="page active">
            <h1 style="font-size: 32px; margin-bottom: 30px; background: linear-gradient(90deg, #6a11cb, #2575fc); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Profile Settings</h1>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 40px;">
                <div>
                    <h3 style="margin-bottom: 20px; color: #6a11cb;">Personal Information</h3>
                    <div style="background: rgba(15, 15, 35, 0.9); padding: 25px; border-radius: 15px; border: 1px solid rgba(106, 17, 203, 0.2);">
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; opacity: 0.7;">Full Name</label>
                                <input type="text" class="form-input" value="${currentUser.name}" readonly>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; opacity: 0.7;">User ID</label>
                                <input type="text" class="form-input" value="${currentUser.id}" readonly>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; opacity: 0.7;">Email</label>
                                <input type="email" class="form-input" value="${currentUser.email}" readonly>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; opacity: 0.7;">Mobile</label>
                                <input type="text" class="form-input" value="${currentUser.mobile}" readonly>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 style="margin-bottom: 20px; color: #6a11cb;">Account Status</h3>
                    <div style="background: rgba(15, 15, 35, 0.9); padding: 25px; border-radius: 15px; border: 1px solid rgba(106, 17, 203, 0.2);">
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; opacity: 0.7;">Account Status</label>
                                <div style="padding: 10px 20px; background: rgba(0, 176, 155, 0.1); border-radius: 10px; color: #00b09b; font-weight: 600; text-transform: uppercase; font-size: 14px;">
                                    ${currentUser.status}
                                </div>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; opacity: 0.7;">KYC Status</label>
                                <div style="padding: 10px 20px; background: rgba(106, 17, 203, 0.1); border-radius: 10px; color: #6a11cb; font-weight: 600; text-transform: uppercase; font-size: 14px;">
                                    ${currentUser.kyc || 'pending'}
                                </div>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; opacity: 0.7;">Join Date</label>
                                <div style="padding: 10px 20px; background: rgba(255, 255, 255, 0.05); border-radius: 10px; color: white;">
                                    ${new Date(currentUser.joinDate).toLocaleDateString()}
                                </div>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; opacity: 0.7;">Last Login</label>
                                <div style="padding: 10px 20px; background: rgba(255, 255, 255, 0.05); border-radius: 10px; color: white;">
                                    ${currentUser.lastLogin ? new Date(currentUser.lastLogin).toLocaleString() : 'Never'}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function getPackagesPage() {
    const packages = [
        { name: 'BASIC', amount: 1000, daily: 5, duration: 30 },
        { name: 'SILVER', amount: 3000, daily: 5, duration: 30 },
        { name: 'GOLD', amount: 5000, daily: 5, duration: 30 },
        { name: 'PLATINUM', amount: 10000, daily: 5, duration: 30 },
        { name: 'DIAMOND', amount: 20000, daily: 5, duration: 30 },
        { name: 'VIP', amount: 50000, daily: 5, duration: 30 }
    ];
    
    let packagesHTML = packages.map(pkg => `
        <div class="package-card">
            <div class="package-badge">${pkg.name}</div>
            <h3 style="font-size: 28px; margin-bottom: 10px; color: #6a11cb;">₹${pkg.amount.toLocaleString()}</h3>
            <div style="margin: 20px 0;">
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                    <i class="fas fa-percentage" style="color: #6a11cb;"></i>
                    <span>Daily Earnings: ${pkg.daily}%</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                    <i class="fas fa-calendar-alt" style="color: #6a11cb;"></i>
                    <span>Duration: ${pkg.duration} Days</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                    <i class="fas fa-tasks" style="color: #6a11cb;"></i>
                    <span>Daily Tasks: 15 Clicks</span>
                </div>
            </div>
            <button class="btn btn-primary" onclick="activatePackage(${pkg.amount}, '${pkg.name}')" style="width: 100%;">
                <i class="fas fa-bolt"></i> Activate Now
            </button>
        </div>
    `).join('');
    
    return `
        <div class="page active">
            <h1 style="font-size: 32px; margin-bottom: 30px; background: linear-gradient(90deg, #6a11cb, #2575fc); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Investment Packages</h1>
            <p style="opacity: 0.7; margin-bottom: 30px;">Choose your investment package and start earning daily returns</p>
            
            <div class="packages-grid">
                ${packagesHTML}
            </div>
        </div>
    `;
}

// ================= PACKAGE FUNCTIONS =================
function activatePackage(amount, packageName) {
    if (!currentUser) {
        showToast('Please login first', 'error');
        return;
    }
    
    if (currentUser.balance < amount) {
        showToast(`Insufficient balance! You need ₹${amount}`, 'error');
        showPage('deposit');
        return;
    }
    
    if (confirm(`Are you sure you want to activate ${packageName} package for ₹${amount}?`)) {
        // Deduct amount
        currentUser.balance -= amount;
        currentUser.investment += amount;
        currentUser.package = packageName;
        
        // Create package activation
        const activationId = 'ACT' + Date.now();
        
        // Add transaction
        addTransaction({
            type: 'package',
            userId: currentUser.id,
            amount: amount,
            description: `${packageName} package activation`
        });
        
        // Save data
        saveCentralData();
        
        // Update UI
        updateUserInfo();
        
        showToast(`${packageName} package activated successfully!`, 'success');
    }
}

// ================= TRANSACTION FUNCTIONS =================
function addTransaction(transaction) {
    const transId = 'TRN' + centralData.transactionIdCounter++;
    
    const fullTransaction = {
        id: transId,
        userId: transaction.userId,
        type: transaction.type,
        amount: transaction.amount,
        description: transaction.description,
        timestamp: new Date().toISOString(),
        status: 'completed'
    };
    
    // Add to central transactions
    centralData.transactions.push(fullTransaction);
    
    // Add to user's transactions
    const user = centralData.users[transaction.userId];
    if (user) {
        if (!user.transactions) user.transactions = [];
        user.transactions.push(fullTransaction);
        
        // Log activity
        if (!user.activityLog) user.activityLog = [];
        user.activityLog.push({
            action: transaction.type,
            amount: transaction.amount,
            timestamp: new Date().toISOString()
        });
    }
    
    // Log system activity
    logActivity(transaction.userId, transaction.type, transaction.amount);
    
    return fullTransaction;
}

// ================= LOGGING FUNCTIONS =================
function logActivity(userId, action, details = null) {
    const log = {
        timestamp: new Date().toISOString(),
        userId: userId,
        action: action,
        details: details,
        device: navigator.userAgent.substring(0, 100),
        ip: 'simulated'
    };
    
    centralData.logs.push(log);
    
    // Keep only last 1000 logs
    if (centralData.logs.length > 1000) {
        centralData.logs = centralData.logs.slice(-500);
    }
}

// ================= ADMIN FUNCTIONS =================
function showAdminPage(page) {
    // Remove active class
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
    });
    
    // Add active class
    event.currentTarget.classList.add('active');
    
    // Load page content
    document.getElementById('adminPageContent').innerHTML = getAdminPageContent(page);
}

function getAdminPageContent(page) {
    switch(page) {
        case 'adminOverview':
            return getAdminOverview();
        case 'adminUsers':
            return getAdminUsers();
        case 'adminTransactions':
            return getAdminTransactions();
        case 'adminDeposits':
            return getAdminDeposits();
        case 'adminWithdrawals':
            return getAdminWithdrawals();
        case 'adminPackages':
            return getAdminPackages();
        case 'adminSettings':
            return getAdminSettings();
        case 'adminReports':
            return getAdminReports();
        default:
            return '<h2>Admin Page</h2>';
    }
}

function getAdminOverview() {
    const totalUsers = Object.keys(centralData.users).length;
    const activeUsers = Object.values(centralData.users).filter(u => u.status === 'active').length;
    const totalBalance = Object.values(centralData.users).reduce((sum, user) => sum + (user.balance || 0), 0);
    const totalInvestment = Object.values(centralData.users).reduce((sum, user) => sum + (user.investment || 0), 0);
    
    return `
        <div class="page active">
            <h1 style="font-size: 32px; margin-bottom: 30px; background: linear-gradient(90deg, #ff416c, #ff4b2b); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Admin Dashboard</h1>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-users stat-icon"></i>
                    <div style="font-size: 14px; opacity: 0.7;">Total Users</div>
                    <div class="stat-value">${totalUsers}</div>
                    <div style="font-size: 12px; opacity: 0.5;">Active: ${activeUsers}</div>
                </div>
                
                <div class="stat-card">
                    <i class="fas fa-money-bill-wave stat-icon"></i>
                    <div style="font-size: 14px; opacity: 0.7;">Total Balance</div>
                    <div class="stat-value">₹${totalBalance.toLocaleString()}</div>
                    <div style="font-size: 12px; opacity: 0.5;">All Users</div>
                </div>
                
                <div class="stat-card">
                    <i class="fas fa-chart-line stat-icon"></i>
                    <div style="font-size: 14px; opacity: 0.7;">Total Investment</div>
                    <div class="stat-value">₹${totalInvestment.toLocaleString()}</div>
                    <div style="font-size: 12px; opacity: 0.5;">Active Packages</div>
                </div>
                
                <div class="stat-card">
                    <i class="fas fa-database stat-icon"></i>
                    <div style="font-size: 14px; opacity: 0.7;">Platform Balance</div>
                    <div class="stat-value">₹${centralData.settings.platformBalance.toLocaleString()}</div>
                    <div style="font-size: 12px; opacity: 0.5;">System Funds</div>
                </div>
            </div>
            
            <div style="margin-top: 40px;">
                <h3 style="margin-bottom: 20px; color: #ff416c;">Recent System Activity</h3>
                <div class="data-table">
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>User</th>
                                <th>Action</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${centralData.logs.slice(-10).reverse().map(log => `
                                <tr>
                                    <td>${new Date(log.timestamp).toLocaleTimeString()}</td>
                                    <td>${log.userId}</td>
                                    <td>${log.action}</td>
                                    <td>${log.details || '-'}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    `;
}

function getAdminUsers() {
    const users = centralData.users;
    let usersHTML = '';
    
    for (const userId in users) {
        const user = users[userId];
        usersHTML += `
            <tr>
                <td>${userId}</td>
                <td>${user.name}</td>
                <td>${user.email}</td>
                <td>${user.mobile}</td>
                <td>₹${user.balance.toLocaleString()}</td>
                <td><span style="padding: 5px 10px; background: ${user.status === 'active' ? 'rgba(0, 176, 155, 0.2)' : 'rgba(255, 65, 108, 0.2)'}; color: ${user.status === 'active' ? '#00b09b' : '#ff416c'}; border-radius: 20px; font-size: 12px;">${user.status}</span></td>
                <td>
                    <button class="btn btn-sm btn-success" onclick="viewUserDetails('${userId}')" style="padding: 5px 10px; font-size: 12px;">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-sm btn-danger" onclick="deleteUser('${userId}')" style="padding: 5px 10px; font-size: 12px; margin-left: 5px;">
                        <i class="fas fa-trash"></i>
                    </button>
                </td>
            </tr>
        `;
    }
    
    return `
        <div class="page active">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h1 style="font-size: 32px; background: linear-gradient(90deg, #ff416c, #ff4b2b); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">All Users</h1>
                <button class="btn btn-primary" onclick="addNewUser()">
                    <i class="fas fa-user-plus"></i> Add User
                </button>
            </div>
            
            <div class="data-table">
                <table style="width: 100%;">
                    <thead>
                        <tr>
                            <th>User ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Mobile</th>
                            <th>Balance</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${usersHTML}
                    </tbody>
                </table>
            </div>
        </div>
    `;
}

function viewUserDetails(userId) {
    const user = centralData.users[userId];
    if (!user) return;
    
    const modalContent = `
        <h2 style="margin-bottom: 20px; color: #6a11cb;">User Details</h2>
        <div style="display: grid; gap: 15px;">
            <div>
                <strong>User ID:</strong> ${user.id}
            </div>
            <div>
                <strong>Name:</strong> ${user.name}
            </div>
            <div>
                <strong>Email:</strong> ${user.email}
            </div>
            <div>
                <strong>Mobile:</strong> ${user.mobile}
            </div>
            <div>
                <strong>Balance:</strong> ₹${user.balance}
            </div>
            <div>
                <strong>Investment:</strong> ₹${user.investment}
            </div>
            <div>
                <strong>Status:</strong> ${user.status}
            </div>
            <div>
                <strong>Join Date:</strong> ${new Date(user.joinDate).toLocaleDateString()}
            </div>
        </div>
        <div style="margin-top: 30px; display: flex; gap: 10px;">
            <button class="btn btn-primary" onclick="editUser('${userId}')" style="flex: 1;">
                <i class="fas fa-edit"></i> Edit
            </button>
            <button class="btn" onclick="closeModal()" style="flex: 1; background: rgba(255, 255, 255, 0.1);">
                Close
            </button>
        </div>
    `;
    
    showModal(modalContent);
}

function addNewUser() {
    const modalContent = `
        <h2 style="margin-bottom: 20px; color: #6a11cb;">Add New User</h2>
        <div style="display: grid; gap: 15px;">
            <input type="text" id="newUserName" class="form-input" placeholder="Full Name">
            <input type="email" id="newUserEmail" class="form-input" placeholder="Email Address">
            <input type="tel" id="newUserMobile" class="form-input" placeholder="Mobile Number">
            <input type="text" id="newUserPassword" class="form-input" placeholder="Password">
            <input type="number" id="newUserBalance" class="form-input" placeholder="Initial Balance" value="100">
        </div>
        <div style="margin-top: 30px; display: flex; gap: 10px;">
            <button class="btn btn-primary" onclick="createNewUser()" style="flex: 1;">
                <i class="fas fa-check"></i> Create
            </button>
            <button class="btn" onclick="closeModal()" style="flex: 1; background: rgba(255, 255, 255, 0.1);">
                Cancel
            </button>
        </div>
    `;
    
    showModal(modalContent);
}

function createNewUser() {
    const name = document.getElementById('newUserName').value;
    const email = document.getElementById('newUserEmail').value;
    const mobile = document.getElementById('newUserMobile').value;
    const password = document.getElementById('newUserPassword').value;
    const balance = parseInt(document.getElementById('newUserBalance').value) || 100;
    
    if (!name || !email || !mobile || !password) {
        showToast('Please fill all fields', 'error');
        return;
    }
    
    const userId = 'USER' + String(centralData.userIdCounter++).padStart(4, '0');
    
    centralData.users[userId] = {
        id: userId,
        name: name,
        email: email,
        mobile: mobile,
        password: password,
        sponsor: 'ADMIN',
        joinDate: new Date().toISOString(),
        status: 'active',
        balance: balance,
        investment: 0,
        earnings: 0,
        referrals: 0,
        package: 'none',
        kyc: 'verified',
        bankDetails: {},
        lastLogin: new Date().toISOString(),
        devices: [navigator.userAgent],
        transactions: [],
        activityLog: []
    };
    
    // Add welcome transaction
    addTransaction({
        type: 'admin_added',
        userId: userId,
        amount: balance,
        description: 'Account created by admin'
    });
    
    saveCentralData();
    closeModal();
    
    // Refresh users table
    showAdminPage('adminUsers');
    
    showToast(`User ${userId} created successfully!`, 'success');
}

function deleteUser(userId) {
    if (confirm(`Are you sure you want to delete user ${userId}? This cannot be undone.`)) {
        delete centralData.users[userId];
        saveCentralData();
        showAdminPage('adminUsers');
        showToast(`User ${userId} deleted`, 'success');
    }
}

// ================= MODAL FUNCTIONS =================
function showModal(content) {
    document.getElementById('modalContent').innerHTML = content;
    document.getElementById('modalOverlay').style.display = 'flex';
}

function closeModal() {
    document.getElementById('modalOverlay').style.display = 'none';
}

// ================= TOAST FUNCTIONS =================
function showToast(message, type = 'info') {
    const toast = document.createElement('div');
    toast.className = 'toast';
    toast.style.background = type === 'error' ? 'linear-gradient(90deg, #ff416c, #ff4b2b)' :
                           type === 'success' ? 'linear-gradient(90deg, #00b09b, #96c93d)' :
                           'linear-gradient(90deg, #6a11cb, #2575fc)';
    toast.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
        ${message}
    `;
    
    document.getElementById('toastContainer').appendChild(toast);
    
    setTimeout(() => {
        toast.style.opacity = '0';
        setTimeout(() => {
            toast.remove();
        }, 300);
    }, 3000);
}

// ================= INITIALIZE UI =================
function initializeUI() {
    isInitialized = true;
    
    // Set default values for demo
    document.getElementById('loginUserId').value = 'USER0001';
    document.getElementById('loginPassword').value = 'password123';
    document.getElementById('adminId').value = 'admin';
    document.getElementById('adminPassword').value = 'admin123';
}

function initializeDashboard() {
    if (currentUser) {
        updateUserInfo();
    }
}

function initializeAdminDashboard() {
    showAdminPage('adminOverview');
}

// Close modal when clicking outside
document.getElementById('modalOverlay').addEventListener('click', function(e) {
    if (e.target === this) {
        closeModal();
    }
});

// Prevent modal close when clicking inside
document.getElementById('modalContent').addEventListener('click', function(e) {
    e.stopPropagation();
});

// ================= PAGE TEMPLATES (CONTINUED) =================
function getDepositPage() {
    return `
        <div class="page active">
            <h1 style="font-size: 32px; margin-bottom: 30px; background: linear-gradient(90deg, #6a11cb, #2575fc); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Deposit Funds</h1>
            
            <div style="max-width: 500px; margin: 0 auto;">
                <div style="background: rgba(15, 15, 35, 0.9); padding: 30px; border-radius: 20px; border: 1px solid rgba(106, 17, 203, 0.2); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px; color: #6a11cb;">Deposit Amount</h3>
                    <input type="number" id="depositAmount" class="form-input" placeholder="Enter amount" min="100" value="1000" style="font-size: 24px; text-align: center; padding: 20px;">
                    <p style="margin-top: 10px; opacity: 0.7; font-size: 14px;">Minimum deposit: ₹100</p>
                </div>
                
                <div style="background: rgba(15, 15, 35, 0.9); padding: 30px; border-radius: 20px; border: 1px solid rgba(106, 17, 203, 0.2); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px; color: #6a11cb;">Payment Method</h3>
                    <div style="display: grid; gap: 15px;">
                        <div style="padding: 20px; background: rgba(106, 17, 203, 0.1); border-radius: 15px; cursor: pointer;" onclick="selectPaymentMethod('upi')">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <i class="fas fa-mobile-alt" style="font-size: 24px; color: #6a11cb;"></i>
                                <div>
                                    <div style="font-weight: 600;">UPI Payment</div>
                                    <div style="opacity: 0.7; font-size: 14px;">Instant transfer via UPI</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="processDeposit()" style="width: 100%; padding: 20px; font-size: 18px;">
                    <i class="fas fa-credit-card"></i> Proceed to Payment
                </button>
            </div>
        </div>
    `;
}

function processDeposit() {
    const amount = parseInt(document.getElementById('depositAmount').value);
    
    if (!amount || amount < 100) {
        showToast('Minimum deposit amount is ₹100', 'error');
        return;
    }
    
    const requestId = 'DEP' + Date.now();
    
    // Add deposit request
    centralData.depositRequests.push({
        id: requestId,
        userId: currentUser.id,
        name: currentUser.name,
        amount: amount,
        method: 'UPI',
        status: 'pending',
        timestamp: new Date().toISOString()
    });
    
    saveCentralData();
    
    showModal(`
        <h2 style="margin-bottom: 20px; color: #6a11cb;">Payment Instructions</h2>
        <div style="margin-bottom: 20px;">
            <p>Please send ₹${amount} to the following UPI ID:</p>
            <div style="background: rgba(106, 17, 203, 0.1); padding: 15px; border-radius: 10px; margin: 15px 0;">
                <strong style="color: #6a11cb;">capitalrise@ybl</strong>
            </div>
            <p style="font-size: 14px; opacity: 0.7;">Make sure to mention your User ID (${currentUser.id}) in the payment note.</p>
        </div>
        <div style="margin-top: 30px;">
            <button class="btn btn-primary" onclick="closeModal()" style="width: 100%;">
                <i class="fas fa-check"></i> I have made the payment
            </button>
        </div>
    `);
    
    showToast(`Deposit request submitted! Request ID: ${requestId}`, 'success');
}

// ================= OTHER PAGE TEMPLATES =================
function getWithdrawPage() {
    if (!currentUser) return '';
    
    return `
        <div class="page active">
            <h1 style="font-size: 32px; margin-bottom: 30px; background: linear-gradient(90deg, #6a11cb, #2575fc); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Withdraw Funds</h1>
            
            <div style="max-width: 500px; margin: 0 auto;">
                <div style="background: rgba(15, 15, 35, 0.9); padding: 30px; border-radius: 20px; border: 1px solid rgba(106, 17, 203, 0.2); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px; color: #6a11cb;">Available Balance</h3>
                    <div style="text-align: center;">
                        <div style="font-size: 48px; font-weight: 700; background: linear-gradient(90deg, #6a11cb, #2575fc); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">₹${currentUser.balance.toLocaleString()}</div>
                        <p style="margin-top: 10px; opacity: 0.7;">Minimum withdrawal: ₹200</p>
                    </div>
                </div>
                
                <div style="background: rgba(15, 15, 35, 0.9); padding: 30px; border-radius: 20px; border: 1px solid rgba(106, 17, 203, 0.2); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px; color: #6a11cb;">Withdrawal Amount</h3>
                    <input type="number" id="withdrawAmount" class="form-input" placeholder="Enter amount" min="200" value="200" style="font-size: 24px; text-align: center; padding: 20px;">
                    <p style="margin-top: 10px; opacity: 0.7; font-size: 14px;">Withdrawal fee: ${centralData.settings.withdrawalFee}%</p>
                </div>
                
                <button class="btn btn-primary" onclick="processWithdrawal()" style="width: 100%; padding: 20px; font-size: 18px;">
                    <i class="fas fa-wallet"></i> Request Withdrawal
                </button>
            </div>
        </div>
    `;
}

function processWithdrawal() {
    if (!currentUser) return;
    
    const amount = parseInt(document.getElementById('withdrawAmount').value);
    const minWithdrawal = centralData.settings.minWithdrawal;
    const fee = (amount * centralData.settings.withdrawalFee) / 100;
    const netAmount = amount - fee;
    
    if (amount < minWithdrawal) {
        showToast(`Minimum withdrawal amount is ₹${minWithdrawal}`, 'error');
        return;
    }
    
    if (amount > currentUser.balance) {
        showToast('Insufficient balance', 'error');
        return;
    }
    
    if (currentUser.kyc !== 'verified') {
        showToast('KYC verification required for withdrawal', 'error');
        return;
    }
    
    const requestId = 'WDR' + Date.now();
    
    // Add withdrawal request
    centralData.withdrawalRequests.push({
        id: requestId,
        userId: currentUser.id,
        name: currentUser.name,
        amount: amount,
        fee: fee,
        netAmount: netAmount,
        status: 'pending',
        timestamp: new Date().toISOString()
    });
    
    // Deduct from user balance immediately
    currentUser.balance -= amount;
    
    saveCentralData();
    updateUserInfo();
    
    showModal(`
        <h2 style="margin-bottom: 20px; color: #6a11cb;">Withdrawal Request Submitted</h2>
        <div style="margin-bottom: 20px;">
            <p>Your withdrawal request has been submitted successfully.</p>
            <div style="background: rgba(106, 17, 203, 0.1); padding: 15px; border-radius: 10px; margin: 15px 0;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Request ID:</span>
                    <strong>${requestId}</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Amount:</span>
                    <strong>₹${amount}</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Fee (${centralData.settings.withdrawalFee}%):</span>
                    <strong>₹${fee}</strong>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Net Amount:</span>
                    <strong style="color: #00b09b;">₹${netAmount}</strong>
                </div>
            </div>
            <p style="font-size: 14px; opacity: 0.7;">Withdrawal will be processed within 24-48 hours.</p>
        </div>
        <div style="margin-top: 30px;">
            <button class="btn btn-primary" onclick="closeModal()" style="width: 100%;">
                <i class="fas fa-check"></i> OK
            </button>
        </div>
    `);
}

// ================= ADDITIONAL ADMIN PAGES =================
function getAdminTransactions() {
    const transactions = centralData.transactions.slice(-50).reverse();
    
    let tableHTML = transactions.map(trans => `
        <tr>
            <td>${trans.id}</td>
            <td>${trans.userId}</td>
            <td>${trans.type}</td>
            <td>₹${trans.amount}</td>
            <td>${trans.description}</td>
            <td>${new Date(trans.timestamp).toLocaleString()}</td>
            <td><span style="padding: 5px 10px; background: rgba(0, 176, 155, 0.2); color: #00b09b; border-radius: 20px; font-size: 12px;">${trans.status}</span></td>
        </tr>
    `).join('');
    
    return `
        <div class="page active">
            <h1 style="font-size: 32px; margin-bottom: 30px; background: linear-gradient(90deg, #ff416c, #ff4b2b); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">All Transactions</h1>
            
            <div class="data-table">
                <table style="width: 100%;">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>User</th>
                            <th>Type</th>
                            <th>Amount</th>
                            <th>Description</th>
                            <th>Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${tableHTML}
                    </tbody>
                </table>
            </div>
        </div>
    `;
}

function getAdminDeposits() {
    const deposits = centralData.depositRequests;
    const pendingDeposits = deposits.filter(d => d.status === 'pending');
    
    let tableHTML = '';
    
    if (pendingDeposits.length === 0) {
        tableHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px;">No pending deposits</td></tr>';
    } else {
        tableHTML = pendingDeposits.map(dep => `
            <tr>
                <td>${dep.id}</td>
                <td>${dep.userId}</td>
                <td>${dep.name}</td>
                <td>₹${dep.amount}</td>
                <td>${dep.method}</td>
                <td>${new Date(dep.timestamp).toLocaleString()}</td>
                <td>
                    <button class="btn btn-sm btn-success" onclick="approveDeposit('${dep.id}')" style="padding: 5px 10px; font-size: 12px;">
                        <i class="fas fa-check"></i> Approve
                    </button>
                    <button class="btn btn-sm btn-danger" onclick="rejectDeposit('${dep.id}')" style="padding: 5px 10px; font-size: 12px; margin-left: 5px;">
                        <i class="fas fa-times"></i> Reject
                    </button>
                </td>
            </tr>
        `).join('');
    }
    
    return `
        <div class="page active">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h1 style="font-size: 32px; background: linear-gradient(90deg, #ff416c, #ff4b2b); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Deposit Requests</h1>
                <div style="padding: 10px 20px; background: rgba(106, 17, 203, 0.1); border-radius: 10px;">
                    Pending: ${pendingDeposits.length}
                </div>
            </div>
            
            <div class="data-table">
                <table style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Request ID</th>
                            <th>User ID</th>
                            <th>Name</th>
                            <th>Amount</th>
                            <th>Method</th>
                            <th>Date</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${tableHTML}
                    </tbody>
                </table>
            </div>
        </div>
    `;
}

function approveDeposit(requestId) {
    const deposit = centralData.depositRequests.find(d => d.id === requestId);
    if (!deposit) return;
    
    const user = centralData.users[deposit.userId];
    if (!user) return;
    
    // Update deposit status
    deposit.status = 'approved';
    deposit.approvedAt = new Date().toISOString();
    
    // Add to user balance
    user.balance += deposit.amount;
    
    // Add transaction
    addTransaction({
        type: 'deposit',
        userId: user.id,
        amount: deposit.amount,
        description: 'Deposit approved'
    });
    
    saveCentralData();
    
    // Refresh page
    showAdminPage('adminDeposits');
    
    showToast(`Deposit of ₹${deposit.amount} approved for ${user.name}`, 'success');
}

function rejectDeposit(requestId) {
    const deposit = centralData.depositRequests.find(d => d.id === requestId);
    if (!deposit) return;
    
    deposit.status = 'rejected';
    deposit.rejectedAt = new Date().toISOString();
    
    saveCentralData();
    
    // Refresh page
    showAdminPage('adminDeposits');
    
    showToast(`Deposit request ${requestId} rejected`, 'success');
}

// ================= EXPORT DATA FUNCTION =================
function exportAllData() {
    const data = {
        users: centralData.users,
        transactions: centralData.transactions,
        logs: centralData.logs,
        settings: centralData.settings,
        exportDate: new Date().toISOString()
    };
    
    const dataStr = JSON.stringify(data, null, 2);
    const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
    
    const exportFileDefaultName = `capitalrise_data_${new Date().toISOString().split('T')[0]}.json`;
    
    const linkElement = document.createElement('a');
    linkElement.setAttribute('href', dataUri);
    linkElement.setAttribute('download', exportFileDefaultName);
    linkElement.click();
    
    showToast('All data exported successfully!', 'success');
}

// ================= INITIALIZE ON LOAD =================
window.onload = function() {
    // Set focus on login input
    document.getElementById('loginUserId')?.focus();
    
    // Add keyboard shortcuts
    document.addEventListener('keydown', function(e) {
        // Ctrl+S to save
        if (e.ctrlKey && e.key === 's') {
            e.preventDefault();
            saveCentralData();
            showToast('Data saved successfully!', 'success');
        }
        
        // Esc to close modal
        if (e.key === 'Escape') {
            closeModal();
        }
    });
};

// ================= FINAL INITIALIZATION =================
console.log('✅ CapitalRise Pro Platform Initialized');
console.log('📊 Central Data System: Active');
console.log('👥 Users in System:', Object.keys(centralData.users).length);
console.log('💾 Storage Key:', STORAGE_KEY);

// Mark as initialized
setTimeout(() => {
    isInitialized = true;
    console.log('🚀 System Ready');
}, 1000);
</script>
</body>
</html>
